# ============================================
# APPLICATION
# ============================================
server.port=8080
spring.application.name=pixel-place

# ============================================
# AXON KAFKA STARTER (NO AXON SERVER)
# ============================================
axon.kafka.bootstrap-servers=localhost:9092

# Topics personalizados
axon.kafka.command.topic=pixel-place-commands
axon.kafka.command.reply-topic=pixel-place-command-replies
axon.kafka.command.dlq-topic=pixel-place-commands-dlq
axon.kafka.event.topic=pixel-place-events

# Consumer Group IDs (REQUERIDOS)
axon.kafka.command.group-id=pixel-place-command-handlers
axon.kafka.command.reply-group-id=pixel-place-command-reply-handlers
axon.kafka.event.group-id=pixel-place-event-processors
axon.kafka.materializer.group-id=pixel-place-event-materializers

# Command Bus Configuration - Aumentado para soportar tiles
axon.kafka.command.concurrency=10
axon.kafka.command.timeout-seconds=30

# Event Configuration
axon.kafka.event.concurrency=5

# Materializer con alta concurrencia
axon.kafka.materializer.concurrency=5
axon.kafka.materializer.timeout-seconds=30
axon.kafka.materializer.consumer-pool-size=5

axon.kafka.topic.auto-correct-partitions=true

# Topic Creation Configuration - TILES STRATEGY
# Para Canvas 1000x1000 con tiles 100x100 = 100 tiles (10x10)
# Cada tile procesa en paralelo en su propia partición
axon.kafka.topic.partitions=100
axon.kafka.topic.replication-factor=1
axon.kafka.topic.retention-hours=168

# ============================================
# POSTGRESQL
# ============================================
spring.datasource.url=jdbc:postgresql://localhost:5432/pixel_place_db
spring.datasource.username=postgres
spring.datasource.password=postgres
spring.datasource.driver-class-name=org.postgresql.Driver

# JPA
spring.jpa.database-platform=org.hibernate.dialect.PostgreSQLDialect
spring.jpa.hibernate.ddl-auto=update
spring.jpa.show-sql=false
spring.jpa.properties.hibernate.format_sql=true

# ============================================
# AXON SERVER (DISABLED - USANDO KAFKA)
# ============================================
axon.axonserver.enabled=false

# ============================================
# LOGGING
# ============================================
logging.level.com.example.pixelplace=DEBUG
logging.level.io.github.axonkafka=DEBUG
logging.level.org.axonframework=INFO
logging.level.org.springframework.kafka=INFO
logging.level.org.apache.kafka=WARN

# ============================================
# PIXEL PLACE CONFIGURATION
# ============================================
# Tamaño del canvas - ACTUALIZADO para tiles strategy
pixel-place.canvas.width=1000
pixel-place.canvas.height=1000

# Configuración de Tiles (NO CAMBIAR sin ajustar particiones)
# Tiles de 100x100 para canvas 1000x1000 = 100 tiles
pixel-place.tiles.size=100
pixel-place.tiles.count-x=10
pixel-place.tiles.count-y=10

# ============================================
# RATE LIMITING - DESHABILITADO
# ============================================
# Control de límite de pixeles por usuario
pixel-place.rate-limit.enabled=false
pixel-place.rate-limit.max-pixels-per-period=3
pixel-place.rate-limit.cooldown-minutes=5
pixel-place.rate-limit.bypass-users=

# ============================================
# IMAGE GENERATION - CONFIGURACIÓN MEJORADA
# ============================================
# Formato de imagen (PNG recomendado para pixel art)
pixel-place.image.format=PNG

# Calidad JPEG (solo si format=JPEG)
pixel-place.image.jpeg-quality=0.9

# Compresión PNG (0-9)
# Nivel 3 para mejor calidad
pixel-place.image.png-compression=3

# Cache de imágenes en memoria (segundos)
pixel-place.image.cache-ttl=60

# Máximo de imágenes en cache
pixel-place.image.cache-max-size=100

# ============================================
# GENERACIÓN AUTOMÁTICA DE IMÁGENES (BATCH)
# ============================================

# Habilitar/deshabilitar generación automática
pixel-place.image.generation.enabled=true

# Modo de batch: TIME, COUNT, HYBRID
pixel-place.image.generation.mode=HYBRID

# Intervalo para batch por tiempo (segundos)
pixel-place.image.generation.batch-interval-seconds=5

# Cantidad de eventos para batch por cantidad (canvas completo)
pixel-place.image.generation.batch-size=10

# Directorio donde guardar imágenes
# Windows: C:/canvas-images
# Linux/Mac: /var/canvas-images
pixel-place.image.generation.storage-directory=D:/projects/canvas-images

# ============================================
# GRID CONFIGURATION - HABILITADO POR DEFECTO
# ============================================
pixel-place.image.generation.default-grid=true

# Versiones de scale para CANVAS COMPLETO
# Ejemplo: 1,5 genera latest.png y latest_5x.png
pixel-place.image.generation.scale-versions=1,5,10

# ============================================
# GENERACIÓN DE TILES
# ============================================

# Habilitar generación de tiles
pixel-place.image.generation.tiles-enabled=true

# Tamaño de cada tile (debe coincidir con TILE_SIZE en PlacePixelCommand)
pixel-place.image.generation.tile-size=100

# Versiones de scale para TILES
# Los tiles generalmente usan scales mayores para ver detalle
pixel-place.image.generation.tile-scale-versions=5,10,20

# Batch size específico para tiles
pixel-place.image.generation.tile-batch-size=5